//CVE:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-22885
int __VERIFIER_nondet_int();
enum js_Class {
    JS_COBJECT,
    JS_CARRAY,
    JS_CFUNCTION,
    JS_CSCRIPT, /* function created from global code */
    JS_CEVAL, /* function created from eval code */
    JS_CCFUNCTION, /* built-in function */
    JS_CERROR,
    JS_CBOOLEAN,
    JS_CNUMBER,
    JS_CSTRING,
    JS_CREGEXP,
    JS_CDATE,
    JS_CMATH,
    JS_CJSON,
    JS_CARGUMENTS,
    JS_CITERATOR,
    JS_CUSERDATA,
};
enum js_Type {
    JS_TSHRSTR, /* type tag doubles as string zero-terminator */
    JS_TUNDEFINED,
    JS_TNULL,
    JS_TBOOLEAN,
    JS_TNUMBER,
    JS_TLITSTR,
    JS_TMEMSTR,
    JS_TOBJECT,
};
struct js_State
{
   char n;
};
struct js_Object;
struct js_Property
{
    const char *name;
   struct js_Property *left, *right;
    int level;
    int atts;
    struct js_Object *object;
    struct js_Object *getter;
    struct js_Object *setter;
    enum js_Type type;
    struct js_Object* memstr;

};
struct js_Object
{
    int gcmark;
    enum js_Class type;
    struct js_Property *properties;
    struct js_Object *prototype;
};


static void jsG_markobject(struct js_State *J, int mark, struct js_Object *obj);

static void jsG_markproperty(struct js_State *J, int mark, struct js_Property *node)
{
    if (node->left->level) jsG_markproperty(J, mark, node->left);
    if (node->right->level) jsG_markproperty(J, mark, node->right);

    if (node->type == JS_TMEMSTR && node->memstr->gcmark != mark)
        node->memstr->gcmark = mark;
    if (node->type == JS_TOBJECT && node->object->gcmark != mark)
        jsG_markobject(J, mark, node->object);
    if (node->getter && node->getter->gcmark != mark)
        jsG_markobject(J, mark, node->getter);
    if (node->setter && node->setter->gcmark != mark)
        jsG_markobject(J, mark, node->setter);
}


static void jsG_markobject(struct js_State *J, int mark, struct js_Object *obj)
{
    obj->gcmark = mark;
    if (obj->properties->level)
        jsG_markproperty(J, mark, obj->properties);
    if (obj->prototype && obj->prototype->gcmark != mark)
        jsG_markobject(J, mark, obj->prototype);

}

int main(){
    struct js_State initial;
    int mark = 1;
    struct js_Property  initObj1;
    struct js_Property  initObj2;
    initObj1.level = 0;
    initObj2.level = 1;
    initObj1.left = &initObj2;
    initObj2.right = &initObj1;
    initObj1.object->properties = &initObj1;
    initObj1.object->prototype->gcmark = 2;


    jsG_markproperty(&initial, mark, &initObj1);


}