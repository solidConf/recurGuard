//CVE-2020-25219
//website:https://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2020-25219
//
//#include <iostream>
#include <string.h>
#include <unistd.h>
#include <stdio.h>
ssize_t recv(int sockfd, void *buf, size_t len, int flags) {
    const char *mock_data = buf;
//    size_t mock_data_len = strlen(mock_data);
    size_t to_copy = (sockfd < len) ? sockfd : len;
    return to_copy;
}
static inline char* recvline(int fd) {
    char c = '\0';
//    printf("%d\n", fd);
    printf("%ld\n", recv(fd, &c, 1, 0));
    if (recv(fd, &c, 1, 0) != 1 || c == '\n')
        return "";

    return c + recvline(fd);
}

int main(){
    int fd = __VERIFIER_nondet_int();
//    printf("%d\n", fd);
    char* receivedLine = recvline(fd);
    printf("%s\n", receivedLine);

}
