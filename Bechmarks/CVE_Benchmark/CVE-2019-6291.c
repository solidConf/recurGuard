//CVE-2019-6291
//website:https://bugzilla.nasm.us/show_bug.cgi?id=3392549
static char i;
static int *(*zxpr) (int, int*);
static int *scalar_mult(int * vect)
{
    int *p = vect;
    return p;
}
static int *expr6(int critical, int (*bexpr)(int, int*))
{
    int type;
    int *e;

    switch (i) {
        case '-':
            return scalar_mult(e);

        case '+':
//            return expr6(critical);

        case '~':
            if (!e)
                return e;

        case '!':
//            e = expr6(critical);
            return e;

        case '(':
            e = bexpr(critical, bexpr);
            if (!e)
                return 0;
            return e;

        default:
            return 0;
    }
}
int main(){
    zxpr = expr6;
    i = '(';
    expr6(i, zxpr);
}
